
# High-level logic vulnerability

This lab doesn't adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a "Lightweight l33t leather jacket".

You can log in to your own account using the following credentials: wiener:peter

---------------------------------------------

References: 

- https://portswigger.net/web-security/logic-flaws/examples




![img](images/High-level%20logic%20vulnerability/1.png)

---------------------------------------------

The POST request generated when the product is added to the cart is:



![img](images/High-level%20logic%20vulnerability/2.png)



We can set the quantity to a negative value but we can not purchase it:



![img](images/High-level%20logic%20vulnerability/2.png)


However we can add the item and then a negative number for other product:



![img](images/High-level%20logic%20vulnerability/3.png)


And the item is purchased:



![img](images/High-level%20logic%20vulnerability/4.png)